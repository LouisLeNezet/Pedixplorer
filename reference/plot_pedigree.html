<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Pedigrees — plot,Pedigree,missing-method • Pedixplorer</title><script src="../lightswitch.js"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet"><script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Pedigrees — plot,Pedigree,missing-method"><meta name="description" content="This function is used to plot a Pedigree object.
It is a wrapper for plot_fromdf()
and ped_to_plotdf() as well as
ped_to_legdf() if legend = TRUE."><meta property="og:description" content="This function is used to plot a Pedigree object.
It is a wrapper for plot_fromdf()
and ped_to_plotdf() as well as
ped_to_legdf() if legend = TRUE."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pedixplorer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Pedixplorer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pedigree_alignment.html">Pedigree alignment details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_kinship.html">Pedigree kinship() details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_object.html">Pedigree object</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_plot.html">Pedigree plotting details</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/LouisLeNezet/Pedixplorer/releases/tag/v1.1.5">Latest devel release : Version 1.1.5</a></li>
    <li><a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/Pedixplorer.html">Latest main release : Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LouisLeNezet/Pedixplorer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot Pedigrees</h1>
      <small class="dont-index">Source: <a href="https://github.com/LouisLeNezet/Pedixplorer/blob/devel/R/plot_pedigree.R" class="external-link"><code>R/plot_pedigree.R</code></a></small>
      <div class="d-none name"><code>plot_pedigree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is used to plot a Pedigree object.</p>
<p>It is a wrapper for <code><a href="plot_fromdf.html">plot_fromdf()</a></code>
and <code><a href="ped_to_plotdf.html">ped_to_plotdf()</a></code> as well as
<code><a href="ped_to_legdf.html">ped_to_legdf()</a></code> if <code>legend = TRUE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'Pedigree,missing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  aff_mark <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  id_lab <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ggplot_gen <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  symbolsize <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  branch <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  packed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  align_parents <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subreg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pconnect <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  fam_to_plot <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  leg_cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  leg_symbolsize <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  leg_loc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  leg_adjx <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  leg_adjy <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  precision <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>,</span>
<span>  ped_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  leg_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  tips <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title_cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  leg_usr <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A Pedigree object.</p></dd>


<dt id="arg-aff-mark">aff_mark<a class="anchor" aria-label="anchor" href="#arg-aff-mark"></a></dt>
<dd><p>If <code>TRUE</code>, add a aff_mark to each box corresponding to the
value of the affection column for each filling scale.</p></dd>


<dt id="arg-id-lab">id_lab<a class="anchor" aria-label="anchor" href="#arg-id-lab"></a></dt>
<dd><p>The column name of the id for each individuals.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>If not <code>NULL</code>, add a label to each box under the id
corresponding to the value of the column given.</p></dd>


<dt id="arg-ggplot-gen">ggplot_gen<a class="anchor" aria-label="anchor" href="#arg-ggplot-gen"></a></dt>
<dd><p>If TRUE add the segments to the ggplot object</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>Character expansion of the text</p></dd>


<dt id="arg-symbolsize">symbolsize<a class="anchor" aria-label="anchor" href="#arg-symbolsize"></a></dt>
<dd><p>Size of the symbols</p></dd>


<dt id="arg-branch">branch<a class="anchor" aria-label="anchor" href="#arg-branch"></a></dt>
<dd><p>defines how much angle is used to connect various levels of
nuclear families.</p></dd>


<dt id="arg-packed">packed<a class="anchor" aria-label="anchor" href="#arg-packed"></a></dt>
<dd><p>Should the Pedigree be compressed.
(i.e. allow diagonal lines connecting parents to children in order
to have a smaller overall width for the plot.)</p></dd>


<dt id="arg-align">align<a class="anchor" aria-label="anchor" href="#arg-align"></a></dt>
<dd><p>For a packed Pedigree, align children under parents <code>TRUE</code>,
to the extent possible given the page width, or align to to the left
margin <code>FALSE</code>.
This argument can be a two element vector, giving the alignment
parameters, or a logical value.
If <code>TRUE</code>, the default is <code>c(1.5, 2)</code>, or if numeric the routine
<code><a href="alignped4.html">alignped4()</a></code> will be called.</p></dd>


<dt id="arg-align-parents">align_parents<a class="anchor" aria-label="anchor" href="#arg-align-parents"></a></dt>
<dd><p>If <code>align_parents = TRUE</code>, go one step further
and try to make both parents of each child have the same depth.
(This is not always possible).
It helps the drawing program by lining up pedigrees that
'join in the middle' via a marriage.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>If <code>force = TRUE</code>, the function will return the depth minus
<code>min(depth)</code> if <code>depth</code> reach a state with no founders
is not possible.</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>For a packed output, the minimum width of the plot, in
inches.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>The title of the plot.</p></dd>


<dt id="arg-subreg">subreg<a class="anchor" aria-label="anchor" href="#arg-subreg"></a></dt>
<dd><p>A 4-element vector for (min x, max x, min depth, max depth),
used to edit away portions of the plot coordinates returned by
<code><a href="ped_to_plotdf.html">ped_to_plotdf()</a></code>.
This is useful for zooming in on a particular region of the Pedigree.</p></dd>


<dt id="arg-pconnect">pconnect<a class="anchor" aria-label="anchor" href="#arg-pconnect"></a></dt>
<dd><p>When connecting parent to children the program will try to
make the connecting line as close to vertical as possible, subject to it
lying inside the endpoints of the line that connects the children by at
least <code>pconnect</code> people.  Setting this option to a large number will
force the line to connect at the midpoint of the children.</p></dd>


<dt id="arg-fam-to-plot">fam_to_plot<a class="anchor" aria-label="anchor" href="#arg-fam-to-plot"></a></dt>
<dd><p>default=1.  If the Pedigree contains multiple families,
this parameter can be used to select which family to plot.
It can be a numeric value or a character value. If numeric, it is the
index of the family to plot returned by <code>unique(x$ped$famid)</code>.
If character, it is the family id to plot.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>default=FALSE.  If TRUE, a legend will be added to the plot.</p></dd>


<dt id="arg-leg-cex">leg_cex<a class="anchor" aria-label="anchor" href="#arg-leg-cex"></a></dt>
<dd><p>default=0.8.  Controls the size of the legend text.</p></dd>


<dt id="arg-leg-symbolsize">leg_symbolsize<a class="anchor" aria-label="anchor" href="#arg-leg-symbolsize"></a></dt>
<dd><p>default=0.5.  Controls the size of the legend symbols.</p></dd>


<dt id="arg-leg-loc">leg_loc<a class="anchor" aria-label="anchor" href="#arg-leg-loc"></a></dt>
<dd><p>default=NULL.  If NULL, the legend will be placed in the
upper right corner of the plot.  Otherwise, a 4-element vector of the form
(x0, x1, y0, y1) can be used to specify the location of the legend.
The legend will be fitted to the specified and might be distorted if the
aspect ratio of the legend is different from the aspect ratio of the
specified location.</p></dd>


<dt id="arg-leg-adjx">leg_adjx<a class="anchor" aria-label="anchor" href="#arg-leg-adjx"></a></dt>
<dd><p>default=0.  Controls the horizontal labels adjustment of
the legend.</p></dd>


<dt id="arg-leg-adjy">leg_adjy<a class="anchor" aria-label="anchor" href="#arg-leg-adjy"></a></dt>
<dd><p>default=0.  Controls the vertical labels adjustment
of the legend.</p></dd>


<dt id="arg-precision">precision<a class="anchor" aria-label="anchor" href="#arg-precision"></a></dt>
<dd><p>The number of significatif numbers to round the
solution to.</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>default=par("lwd"). Controls the line width of the
segments, arcs and polygons.</p></dd>


<dt id="arg-ped-par">ped_par<a class="anchor" aria-label="anchor" href="#arg-ped-par"></a></dt>
<dd><p>default=list().  A list of parameters to use as graphical
parameteres for the main plot.</p></dd>


<dt id="arg-leg-par">leg_par<a class="anchor" aria-label="anchor" href="#arg-leg-par"></a></dt>
<dd><p>default=list().  A list of parameters to use as graphical
parameters for the legend.</p></dd>


<dt id="arg-tips">tips<a class="anchor" aria-label="anchor" href="#arg-tips"></a></dt>
<dd><p>A character vector of the column names of the data frame to
use as tooltips. If <code>NULL</code>, no tooltips are added.</p></dd>


<dt id="arg-title-cex">title_cex<a class="anchor" aria-label="anchor" href="#arg-title-cex"></a></dt>
<dd><p>The size of the title.</p></dd>


<dt id="arg-leg-usr">leg_usr<a class="anchor" aria-label="anchor" href="#arg-leg-usr"></a></dt>
<dd><p>default=NULL. A vector of user coordinates to use for the
legend.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an invisible list containing</p><ul><li><p>df : the data.frame used to plot the Pedigree</p></li>
<li><p>par_usr : the user coordinates used to plot the Pedigree</p></li>
<li><p>ggplot : the ggplot object if ggplot_gen = TRUE</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Two important parameters control the looks of the result.  One is the user
specified maximum width.  The smallest possible width is the maximum number
of subjects on a line, if the user's suggestion is too low it is
increased to 1 + that amount (to give just a little wiggle room).</p>
<p>To make a Pedigree where all children are centered under parents simply
make the width large enough, however, the symbols may get very small.</p>
<p>The second is <code>align</code>, a vector of 2 alignment parameters <code>a</code> and
<code>b</code>.
For each set of siblings at a set of locations <code>x</code> and with parents at
<code>p=c(p1,p2)</code> the alignment penalty is</p>
<p>$$(1/k^a)\sum{i=1}{k} [(x_i - (p1+p2)/2)]^2$$</p>
<p>$$\sum(x- \overline(p))^2/(k^a)$$</p>
<p>Where k is the number of siblings in the set.</p>
<p>When <code>a = 1</code> moving a sibship with <code>k</code> sibs one unit to the
left or right of optimal will incur the same cost as moving one with
only 1 or two sibs out of place.</p>
<p>If <code>a = 0</code> then large sibships are harder to move than small ones,
with the default value <code>a = 1.5</code> they are slightly easier to move
than small ones.  The rationale for the default is as long as the parents
are somewhere between the first and last siblings the result looks fairly
good, so we are more flexible with the spacing of a large family.
By tethering all the sibs to a single spot they are kept close to each other.
The alignment penalty for spouses is \(b(x_1 - x_2)^2\),
which tends to keep them together. The size of <code>b</code> controls the relative
importance of sib-parent and spouse-spouse closeness.</p>
    </div>
    <div class="section level2">
    <h2 id="side-effects">Side Effects<a class="anchor" aria-label="anchor" href="#side-effects"></a></h2>


<p>Creates plot on current plotting device.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Pedigree-class.html">Pedigree()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pedAll</span> <span class="op">&lt;-</span> <span class="fu"><a href="Pedigree-class.html">Pedigree</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pedAll</span><span class="op">)</span> <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Le Nezet, Jason Sinnwell, Terry Therneau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

