<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Alignment second routine — alignped2 • Pedixplorer</title><script src="../lightswitch.js"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet"><script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alignment second routine — alignped2"><meta name="description" content="Second of the four co-routines which takes a collection of siblings,
grows the tree for each, and appends them side by side into a single tree."><meta property="og:description" content="Second of the four co-routines which takes a collection of siblings,
grows the tree for each, and appends them side by side into a single tree."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pedixplorer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Pedixplorer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pedigree_alignment.html">Pedigree alignment details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_kinship.html">Pedigree kinship() details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_object.html">Pedigree object</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_plot.html">Pedigree plotting details</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/LouisLeNezet/Pedixplorer/releases/tag/v1.1.4">Version 1.1.4</a></li>
    <li><a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/Pedixplorer.html">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LouisLeNezet/Pedixplorer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Alignment second routine</h1>
      <small class="dont-index">Source: <a href="https://github.com/LouisLeNezet/Pedixplorer/blob/devel/R/alignped2.R" class="external-link"><code>R/alignped2.R</code></a></small>
      <div class="d-none name"><code>alignped2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Second of the four co-routines which takes a collection of siblings,
grows the tree for each, and appends them side by side into a single tree.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">alignped2</span><span class="op">(</span><span class="va">idx</span>, <span class="va">dadx</span>, <span class="va">momx</span>, <span class="va">level</span>, <span class="va">horder</span>, <span class="va">packed</span>, <span class="va">spouselist</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-idx">idx<a class="anchor" aria-label="anchor" href="#arg-idx"></a></dt>
<dd><p>Indexes of the subjects</p></dd>


<dt id="arg-dadx">dadx<a class="anchor" aria-label="anchor" href="#arg-dadx"></a></dt>
<dd><p>Indexes of the fathers</p></dd>


<dt id="arg-momx">momx<a class="anchor" aria-label="anchor" href="#arg-momx"></a></dt>
<dd><p>Indexes of the mothers</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Vector of the level of each subject</p></dd>


<dt id="arg-horder">horder<a class="anchor" aria-label="anchor" href="#arg-horder"></a></dt>
<dd><p>A named numeric vector with one element per subject in the
Pedigree.  It determines the relative horizontal order of subjects within a
sibship, as well as the relative order of processing for the founder couples.
(For this latter, the female founders are ordered as though
they were sisters).
The names of the vector should be the individual identifiers.</p></dd>


<dt id="arg-packed">packed<a class="anchor" aria-label="anchor" href="#arg-packed"></a></dt>
<dd><p>Should the Pedigree be compressed.
(i.e. allow diagonal lines connecting parents to children in order
to have a smaller overall width for the plot.)</p></dd>


<dt id="arg-spouselist">spouselist<a class="anchor" aria-label="anchor" href="#arg-spouselist"></a></dt>
<dd><p>Matrix of spouses with 4 columns:</p><ul><li><p><code>1</code>: husband index</p></li>
<li><p><code>2</code>: wife index</p></li>
<li><p><code>3</code>: husband anchor</p></li>
<li><p><code>4</code>: wife anchor</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the elements to plot the Pedigree.
It contains a set of matrices along with the spouselist matrix.
The latter has marriages removed as they are processed.</p><ul><li><p><code>n</code> : A vector giving the number of subjects on each horizonal
level of the plot</p></li>
<li><p><code>nid</code> : A matrix with one row for each level, giving the numeric
id of each subject plotted.
(A value of <code>17</code> means the 17th subject in the Pedigree).</p></li>
<li><p><code>pos</code> : A matrix giving the horizontal position of each plot point</p></li>
<li><p><code>fam</code> : A matrix giving the family id of each plot point.
A value of <code>3</code> would mean that the two subjects in positions 3 and 4,
in the row above, are this subject's parents.</p></li>
<li><p><code>spouselist</code> : Spouse matrix with anchors informations</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The input arguments are the same as those to <code><a href="alignped1.html">alignped1()</a></code> with the
exception that <strong>idx</strong> will be a vector. This routine does nothing
to the spouselist matrix, but needs to pass it down the tree and back
since one of the routines called by <code>alignped2()</code> might change the matrix.</p>
<p>The code below has one non-obvious special case. Suppose that two sibs marry.
When the first sib is processed by <code>alignped1</code> then both partners
(and any children) will be added to the rval structure below.
When the second sib is processed they will come back as a 1 element tree
(the marriage will no longer be on the <strong>spouselist</strong>),
which should be added onto rval.
The rule thus is to not add any 1 element tree whose value
(which must be <code>idx[i]</code> is already in the rval structure for this level.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="align.html">align()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="Pedigree-class.html">Pedigree</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="align.html">align</a></span><span class="op">(</span><span class="va">ped</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  2 10 16 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$nid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   35   36    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    2    3    4   37   38    5    6    7     8     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    9   10   11   12   14   39   40   41   14    15    12    18    17    16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   21   22   23   24   27   28   25   26   29    30    31    32    33    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    19    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12] [,13]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  3.8  4.8  0.0  0.0 0.00 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0  1.0  2.8  3.8 4.80 5.80 11.25 12.25 14.01 15.01  0.00  0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0  1.0  2.0  3.0 4.00 5.00  6.00  7.00  8.00  9.00 10.00 11.00 12.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0  1.0  2.0  3.0 6.01 7.01  8.01  9.01 10.01 11.01 12.01 13.01 14.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,14] [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.00     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.00     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 13.00    14    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 15.01     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$fam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    1    0    0    1    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    3    3    3    3    5    5    5    0     7     0     7     0     7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    1    1    1    1    9    9   11   11   13    15    15    15    15    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     7     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$spouse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    0    1    0    1    0    1    0    1     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    0    0    0    0    0    0    0    1     0     1     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 7 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$nid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    2    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    3    4    5    6    7    9    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   10   11   12   13   14    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  2.7  3.7  0.0  0.0  0.0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0  1.0  2.0  3.0  4.0    5    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0  1.0  4.5  5.5  6.5    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$fam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1    1    1    1    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    1    6    6    6    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$spouse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    0    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Le Nézet, Jason Sinnwell, Terry Therneau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

