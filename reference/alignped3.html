<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Alignment third routine — alignped3 • Pedixplorer</title><script src="../lightswitch.js"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet"><script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alignment third routine — alignped3"><meta name="description" content="Third of the four co-routines to merges two pedigree trees which
are side by side into a single object."><meta property="og:description" content="Third of the four co-routines to merges two pedigree trees which
are side by side into a single object."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pedixplorer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Pedixplorer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pedigree_alignment.html">Pedigree alignment details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_kinship.html">Pedigree kinship() details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_object.html">Pedigree object</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_plot.html">Pedigree plotting details</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/LouisLeNezet/Pedixplorer/releases/tag/v1.1.4">Version 1.1.4</a></li>
    <li><a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/Pedixplorer.html">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LouisLeNezet/Pedixplorer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Alignment third routine</h1>
      <small class="dont-index">Source: <a href="https://github.com/LouisLeNezet/Pedixplorer/blob/devel/R/alignped3.R" class="external-link"><code>R/alignped3.R</code></a></small>
      <div class="d-none name"><code>alignped3.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Third of the four co-routines to merges two pedigree trees which
are side by side into a single object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">alignped3</span><span class="op">(</span><span class="va">alt1</span>, <span class="va">alt2</span>, <span class="va">packed</span>, space <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-alt-">alt1<a class="anchor" aria-label="anchor" href="#arg-alt-"></a></dt>
<dd><p>Alignment of the first tree</p></dd>


<dt id="arg-alt-">alt2<a class="anchor" aria-label="anchor" href="#arg-alt-"></a></dt>
<dd><p>Alignment of the second tree</p></dd>


<dt id="arg-packed">packed<a class="anchor" aria-label="anchor" href="#arg-packed"></a></dt>
<dd><p>Should the Pedigree be compressed.
(i.e. allow diagonal lines connecting parents to children in order
to have a smaller overall width for the plot.)</p></dd>


<dt id="arg-space">space<a class="anchor" aria-label="anchor" href="#arg-space"></a></dt>
<dd><p>Space between two subjects</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the elements to plot the Pedigree.
It contains a set of matrices along with the spouselist matrix.
The latter has marriages removed as they are processed.</p><ul><li><p><code>n</code> : A vector giving the number of subjects on each horizonal
level of the plot</p></li>
<li><p><code>nid</code> : A matrix with one row for each level, giving the numeric
id of each subject plotted.
(A value of <code>17</code> means the 17th subject in the Pedigree).</p></li>
<li><p><code>pos</code> : A matrix giving the horizontal position of each plot point</p></li>
<li><p><code>fam</code> : A matrix giving the family id of each plot point.
A value of <code>3</code> would mean that the two subjects in positions
3 and 4, in the row above, are this subject's parents.</p></li>
<li><p><code>spouselist</code> : Spouse matrix with anchors informations</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The primary special case is when the rightmost person in
the left tree is the same as the leftmost person in the right tree; we
need not plot two copies of the same person side by side.
(When initializing the output structures do not worry about this,
there is no harm if they are a column bigger than finally needed.)
Beyond that the work is simple book keeping.</p><div class="section">
<h3 id="-slide-">1. Slide:<a class="anchor" aria-label="anchor" href="#-slide-"></a></h3>


<p>For the unpacked case, which is the traditional way to draw
a Pedigree when we can assume the paper is infinitely wide, all parents are
centered over their children. In this case we think if the two trees to be
merged as solid blocks. On input they both have a left margin of 0.
Compute how far over we have to slide the right tree.</p>
</div>

<div class="section">
<h3 id="-merge-">2. Merge:<a class="anchor" aria-label="anchor" href="#-merge-"></a></h3>


<p>Now merge the two trees. Start at the top level and work down.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="align.html">align()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="Pedigree-class.html">Pedigree</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="align.html">align</a></span><span class="op">(</span><span class="va">ped</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  2 10 16 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$nid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   35   36    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    2    3    4   37   38    5    6    7     8     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    9   10   11   12   14   39   40   41   14    15    12    18    17    16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   21   22   23   24   27   28   25   26   29    30    31    32    33    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    19    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12] [,13]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  3.8  4.8  0.0  0.0 0.00 0.00  0.00  0.00  0.00  0.00  0.00  0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0  1.0  2.8  3.8 4.80 5.80 11.25 12.25 14.01 15.01  0.00  0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0  1.0  2.0  3.0 4.00 5.00  6.00  7.00  8.00  9.00 10.00 11.00 12.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0  1.0  2.0  3.0 6.01 7.01  8.01  9.01 10.01 11.01 12.01 13.01 14.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,14] [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.00     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.00     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 13.00    14    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 15.01     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$fam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    1    0    0    1    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    3    3    3    3    5    5    5    0     7     0     7     0     7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    1    1    1    1    9    9   11   11   13    15    15    15    15    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     7     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$spouse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    0    1    0    1    0    1    0    1     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    0    0    0    0    0    0    0    1     0     1     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 7 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$nid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    2    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    3    4    5    6    7    9    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   10   11   12   13   14    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  2.7  3.7  0.0  0.0  0.0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0  1.0  2.0  3.0  4.0    5    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0  1.0  4.5  5.5  6.5    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$fam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1    1    1    1    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    1    6    6    6    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$spouse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    0    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Le Nézet, Jason Sinnwell, Terry Therneau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

