<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Alignment first routine — alignped1 • Pedixplorer</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alignment first routine — alignped1"><meta name="description" content="First alignment routine which create the subtree founded on a single
subject as though it were the only tree."><meta property="og:description" content="First alignment routine which create the subtree founded on a single
subject as though it were the only tree."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pedixplorer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Pedixplorer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pedigree_alignment.html">Pedigree alignment details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_kinship.html">Pedigree kinship() details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_object.html">Pedigree object</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_plot.html">Pedigree plotting details</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/LouisLeNezet/Pedixplorer/releases/tag/v1.1.5">Latest devel release : Version 1.1.5</a></li>
    <li><a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/Pedixplorer.html">Latest main release : Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LouisLeNezet/Pedixplorer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Alignment first routine</h1>
      <small class="dont-index">Source: <a href="https://github.com/LouisLeNezet/Pedixplorer/blob/math/R/alignped1.R" class="external-link"><code>R/alignped1.R</code></a></small>
      <div class="d-none name"><code>alignped1.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>First alignment routine which create the subtree founded on a single
subject as though it were the only tree.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">alignped1</span><span class="op">(</span><span class="va">idx</span>, <span class="va">dadx</span>, <span class="va">momx</span>, <span class="va">level</span>, <span class="va">horder</span>, <span class="va">packed</span>, <span class="va">spouselist</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-idx">idx<a class="anchor" aria-label="anchor" href="#arg-idx"></a></dt>
<dd><p>Indexes of the subjects</p></dd>


<dt id="arg-dadx">dadx<a class="anchor" aria-label="anchor" href="#arg-dadx"></a></dt>
<dd><p>Indexes of the fathers</p></dd>


<dt id="arg-momx">momx<a class="anchor" aria-label="anchor" href="#arg-momx"></a></dt>
<dd><p>Indexes of the mothers</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Vector of the level of each subject</p></dd>


<dt id="arg-horder">horder<a class="anchor" aria-label="anchor" href="#arg-horder"></a></dt>
<dd><p>A named numeric vector with one element per subject in the
Pedigree.  It determines the relative horizontal order of subjects within a
sibship, as well as the relative order of processing for the founder couples.
(For this latter, the female founders are ordered as though
they were sisters).
The names of the vector should be the individual identifiers.</p></dd>


<dt id="arg-packed">packed<a class="anchor" aria-label="anchor" href="#arg-packed"></a></dt>
<dd><p>Should the Pedigree be compressed.
(i.e. allow diagonal lines connecting parents to children in order
to have a smaller overall width for the plot.)</p></dd>


<dt id="arg-spouselist">spouselist<a class="anchor" aria-label="anchor" href="#arg-spouselist"></a></dt>
<dd><p>Matrix of spouses with 4 columns:</p><ul><li><p><code>1</code>: husband index</p></li>
<li><p><code>2</code>: wife index</p></li>
<li><p><code>3</code>: husband anchor</p></li>
<li><p><code>4</code>: wife anchor</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the elements to plot the Pedigree.
It contains a set of matrices along with the spouselist matrix.
The latter has marriages removed as they are processed.</p><ul><li><p><code>n</code> : A vector giving the number of subjects on each horizonal
level of the plot</p></li>
<li><p><code>nid</code> : A matrix with one row for each level, giving the numeric
id of each subject plotted.
(A value of <code>17</code> means the 17th subject in the Pedigree).</p></li>
<li><p><code>pos</code> : A matrix giving the horizontal position of each plot point</p></li>
<li><p><code>fam</code> : A matrix giving the family id of each plot point.
A value of <code>3</code> would mean that the two subjects in positions
3 and 4, in the row above, are this subject's parents.</p></li>
<li><p><code>spouselist</code> : Spouse matrix with anchors informations</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In this routine the <strong>nid</strong> array consists of the final
<code>nid array + 1/2</code> of the final spouse array.
Note that the <strong>spouselist</strong> matrix will only contain spouse pairs
that are not yet processed. The logic for anchoring is slightly tricky.</p><div class="section">
<h3 id="-anchoring-">1. Anchoring:<a class="anchor" aria-label="anchor" href="#-anchoring-"></a></h3>


<p>First, if col 4 of the spouselist matrix is 0, we anchor at the first
opportunity. Also note that if <code>spouselist[, 3] == spouselist[, 4]</code>
it is the husband who is the anchor (just write out the possibilities).</p>
</div>

<div class="section">
<h3 id="-return-values-initialization-">2. Return values initialization:<a class="anchor" aria-label="anchor" href="#-return-values-initialization-"></a></h3>


<p>Create the set of 3 return structures, which will be matrices
with <code>1 + nspouse</code> columns.
If there are children then other routines will widen the result.</p>
</div>

<div class="section">
<h3 id="-create-lspouse-and-rspouse-">3. Create <strong>lspouse</strong> and <strong>rspouse</strong>:<a class="anchor" aria-label="anchor" href="#-create-lspouse-and-rspouse-"></a></h3>


<p>This two complimentary lists denote the spouses plotted on the left
and on the right.
For someone with lots of spouses we try to split them evenly.
If the number of spouses is odd, then men should have more on
the right than on the left, women more on the right.
Any hints in the spouselist matrix override.
We put the undecided marriages closest to <strong>idx</strong>, then add
predetermined ones to the left and right. The majority of marriages will
be undetermined singletons, for which <strong>nleft</strong> will be <code>1</code> for
female (put my husband to the left) and <code>0</code> for male. In one bug found
by plotting canine data, lspouse could initially be empty but
<code>length(rspouse) &gt; 1</code>. This caused <code>nleft &gt; length(indx)</code>.
A fix was to not let <strong>indx</strong> to be indexed beyond its length,
fix by JPS 5/2013.</p>
</div>

<div class="section">
<h3 id="-list-the-children-">4. List the children:<a class="anchor" aria-label="anchor" href="#-list-the-children-"></a></h3>


<p>For each spouse get the list of children. If there are any we
call <code><a href="alignped2.html">alignped2()</a></code> to generate their tree and
then mark the connection to their parent.
If multiple marriages have children we need to join the trees.</p>
</div>

<div class="section">
<h3 id="-splice-the-tree-">5. Splice the tree:<a class="anchor" aria-label="anchor" href="#-splice-the-tree-"></a></h3>


<p>To finish up we need to splice together the tree made up from
all the kids, which only has data from <code>lev + 1</code> down, with the data here.
There are 3 cases:</p><ol><li><p>No children were found.</p></li>
<li><p>The tree below is wider than the tree here, in which case we add
the data from this level onto theirs.</p></li>
<li><p>The tree below is narrower, for instance an only child.</p></li>
</ol></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="align.html">align()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pedi</span> <span class="op">&lt;-</span> <span class="fu"><a href="Pedigree-class.html">Pedigree</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="align.html">align</a></span><span class="op">(</span><span class="va">pedi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  2 10 16 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$nid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   35   36    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    2    3    4   37   38    5    6    7     8     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    9   10   11   12   14   39   40   41   14    15    12    18    17    16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   21   22   23   24   27   28   25   26   29    30    31    32    33    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    19    20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 3.804 4.804 0.000 0.000 0.000 0.000  0.00  0.00  0.00  0.00  0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.000 1.000 2.804 3.804 4.804 5.804 11.25 12.25 14.01 15.01  0.00  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.000 1.000 2.000 3.000 4.000 5.000  6.00  7.00  8.00  9.00 10.00 11.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.000 1.000 2.000 3.000 6.010 7.010  8.01  9.01 10.01 11.01 12.01 13.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,13] [,14] [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.00  0.00     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.00  0.00     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 12.00 13.00    14    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 14.01 15.01     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$fam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    1    0    0    1    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    3    3    3    3    5    5    5    0     7     0     7     0     7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    1    1    1    1    9    9   11   11   13    15    15    15    15    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     7     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1`$spouse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    0    1    0    1    0    1    0    1     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    0    0    0    0    0    0    0    1     0     1     0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,15] [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 7 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$nid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    2    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    3    4    5    6    7    9    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   10   11   12   13   14    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  2.7  3.7  0.0  0.0  0.0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0  1.0  2.0  3.0  4.0    5    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0  1.0  4.5  5.5  6.5    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$fam</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1    1    1    1    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    1    6    6    6    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`2`$spouse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    0    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Le Nezet, Jason Sinnwell, Terry Therneau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

