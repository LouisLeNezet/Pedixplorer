<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Pedigree object • Pedixplorer</title>
<script src="../lightswitch.js"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pedigree object">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pedixplorer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/Pedixplorer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pedigree_alignment.html">Pedigree alignment details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_kinship.html">Pedigree kinship() details</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_object.html">Pedigree object</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree_plot.html">Pedigree plotting details</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/LouisLeNezet/Pedixplorer/releases/tag/v1.1.5">Latest devel release : Version 1.1.5</a></li>
    <li><a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/Pedixplorer.html">Latest main release : Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LouisLeNezet/Pedixplorer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Pedigree object</h1>
                        <h4 data-toc-skip class="author">Terry Therneau,
Elizabeth Atkinson, Louis Le Nézet</h4>
            
            <h4 data-toc-skip class="date">09 February, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/LouisLeNezet/Pedixplorer/blob/devel/vignettes/pedigree_object.Rmd" class="external-link"><code>vignettes/pedigree_object.Rmd</code></a></small>
      <div class="d-none name"><code>pedigree_object.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The pedigree routines came out of a simple need – to quickly draw a
Pedigree structure on the screen, within R, that was “good enough” to
help with debugging the actual routines of interest, which were those
for fitting mixed effecs Cox models to large family data. As such the
routine had compactness and automation as primary goals; complete
annotation (monozygous twins, multiple types of affected status) and
most certainly elegance were not on the list. Other software could do
that much better.</p>
<p>It therefore came as a major surprise when these routines proved
useful to others. Through their constant feedback, application to more
complex pedigrees, and ongoing requests for one more feature, the
routine has become what it is today. This routine is still not suitable
for really large pedigrees, nor for heavily inbred ones such as in
animal studies, and will likely not evolve in that way. The authors
fondest hope is that others will pick up the project.</p>
</div>
<div class="section level2">
<h2 id="pedigree-constructor">Pedigree Constructor<a class="anchor" aria-label="anchor" href="#pedigree-constructor"></a>
</h2>
<div class="section level3">
<h3 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h3>
<p>The Pedigree function is the first step, creating an object of class
Pedigree. It accepts the following input</p>
<ul>
<li>
<code>ped_df</code> A dataframe containing the columns
<ul>
<li>
<code>id</code> A numeric or character vector of subject
identifiers.</li>
<li>
<code>dadid</code> The identifier of the father.</li>
<li>
<code>momid</code> The identifier of the mother.</li>
<li>
<code>sex</code> The gender of the individual. This can be a numeric
variable with codes of <code>1</code>=male, <code>2</code>=female,
<code>3</code>=unknown, <code>4</code>=terminated, or NA=unknown. A
character or factor variable can also be supplied containing the above;
the string may be truncated and of arbitrary case.</li>
<li>
<code>avail</code> Optional, a numeric variable with
<code>0</code>=unavailable and <code>1</code>=available.</li>
<li>
<code>affected</code> Optional, a numeric variable with
<code>0</code>=unaffected and <code>1</code>=affected.</li>
<li>
<code>deceased</code> Optional, a numeric variable with
<code>0</code>=alive and <code>1</code>=dead.</li>
<li>
<code>famid</code> Optional, a numeric or character vector of family
identifiers.</li>
<li>
<code>steril</code> Optional, a numeric variable with
<code>0</code>=not steril and <code>1</code>=steril.</li>
</ul>
</li>
<li>
<code>rel_df</code> Optional, a data frame with three columns or
four columns.
<ul>
<li>
<code>id1</code> identifier values of the subject pairs</li>
<li>
<code>id2</code> identifier values of the subject pairs</li>
<li>
<code>code</code> relationship codification :
<code>1</code>=Monozygotic twin, <code>2</code>=Dizygotic twin,
<code>3</code>=twin of unknown zygosity, <code>4</code>=Spouse.</li>
<li>
<code>famid</code> Optional, a numeric or character vector of family
identifiers.</li>
</ul>
</li>
<li>
<code>cols_ren_ped</code> Optional, a named list for the renaming of
the <code>ped_df</code> dataframe</li>
<li>
<code>cols_ren_rel</code> Optional, a named list for the renaming of
the <code>rel_df</code> dataframe</li>
<li>
<code>normalize</code> Optional, a logical to know if the data
should be normalised.</li>
<li>
<code>hints</code> Optional, a list containing the horder in which
to plot the individuals and the matrix of the spouse.</li>
</ul>
</div>
<div class="section level3">
<h3 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h3>
<p>Note that a factor variable is not listed as one of the choices for
the subject identifier. This is on purpose. Factors were designed to
accomodate character strings whose values came from a limited class –
things like race or gender, and are not appropriate for a subject
identifier. All of their special properties as compared to a character
variable turn out to be backwards for this case, in particular a memory
of the original level set when subscripting is done.</p>
<p>However, due to the awful decision early on in S to automatically
turn every character into a factor — unless you stood at the door with a
club to head the package off — most users have become ingrained to the
idea of using them for every character variable.</p>
<p>(I encourage you to set the global option
<code>stringsAsFactors = FALSE</code> to turn off autoconversion – it
will measurably improve your R experience).</p>
<p>Therefore, to avoid unnecessary hassle for our users the code will
accept a factor as input for the id variables, but the final structure
does not retain it. Gender and relation do become factors. Status
follows the pattern of the survival routines and remains an integer.</p>
</div>
<div class="section level3">
<h3 id="column-renaming">Column renaming<a class="anchor" aria-label="anchor" href="#column-renaming"></a>
</h3>
<p>Based on the dataframe given for <code>ped_df</code> and
<code>rel_df</code> and their corresponding named list, the columns are
renamed for them to be used correctly. The renaming is done as
follow</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rel_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    indId1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"110"</span>, <span class="st">"204"</span><span class="op">)</span>,</span>
<span>    indId2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"112"</span>, <span class="st">"205"</span><span class="op">)</span>,</span>
<span>    code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cols_ren_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    id1 <span class="op">=</span> <span class="st">"indId1"</span>,</span>
<span>    id2 <span class="op">=</span> <span class="st">"indId2"</span>,</span>
<span>    famid <span class="op">=</span> <span class="st">"family"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Rename columns rel</span></span>
<span><span class="va">old_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">cols_ren_rel</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cols_ren_rel</span><span class="op">)</span></span>
<span><span class="va">cols_to_ren</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">old_cols</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rel_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rel_df</span><span class="op">)</span><span class="op">[</span><span class="va">cols_to_ren</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cols_to_ren</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">new_cols</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cols_to_ren</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rel_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   id1 id2 code famid</span></span>
<span><span class="co">## 1 110 112    1     1</span></span>
<span><span class="co">## 2 204 205    2     2</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="normalisation">Normalisation<a class="anchor" aria-label="anchor" href="#normalisation"></a>
</h3>
<p>If the normalisation process is selected
<code>normalize = TRUE</code>, then both dataframe will be checked by
their dedicated normalization function. It will ensure that all
modalities are written correctly and set up the right way. If a
<code>famid</code> column is present in the dataframe, then it will be
aggregated to the id of each individual and separated by an ’’_’’ to
ensure the uniqueness of the individuals identifiers.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://louislenezet.github.io/Pedixplorer/">Pedixplorer</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sampleped"</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"id"</span>, <span class="st">"avail"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">[</span><span class="va">cols</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       sex             id                avail       </span></span>
<span><span class="co">##  Min.   :1.000   Length:55          Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:1.000   Class :character   1st Qu.:0.0000  </span></span>
<span><span class="co">##  Median :1.000   Mode  :character   Median :0.0000  </span></span>
<span><span class="co">##  Mean   :1.491                      Mean   :0.4364  </span></span>
<span><span class="co">##  3rd Qu.:2.000                      3rd Qu.:1.0000  </span></span>
<span><span class="co">##  Max.   :2.000                      Max.   :1.0000</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pedigree-class.html">Pedigree</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/Pedigree-class.html">ped</a></span><span class="op">(</span><span class="va">ped</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">cols</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          sex          id              avail        </span></span>
<span><span class="co">##  male      :28   Length:55          Mode :logical  </span></span>
<span><span class="co">##  female    :27   Class :character   FALSE:31       </span></span>
<span><span class="co">##  unknown   : 0   Mode  :character   TRUE :24       </span></span>
<span><span class="co">##  terminated: 0</span></span></code></pre>
<div class="section level4">
<h4 id="errors-present-after-the-normalisation-process">Errors present after the normalisation process<a class="anchor" aria-label="anchor" href="#errors-present-after-the-normalisation-process"></a>
</h4>
<p>If any error is detected after the normalisation process, then the
normalised dataframe is gave back to the user with errors column added
describing the encountered problems.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rel_wrong</span> <span class="op">&lt;-</span> <span class="va">rel_df</span></span>
<span><span class="va">rel_wrong</span><span class="op">$</span><span class="va">code</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"A"</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pedigree-class.html">Pedigree</a></span><span class="op">(</span><span class="va">sampleped</span>, <span class="va">rel_wrong</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in .local(obj, ...): The relationship informations are not valid. Here</span></span>
<span><span class="co">## is the normalised relationship informations with the identified problems</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     id1   id2    code famid              error</span></span>
<span><span class="co">## 1 1_110 1_112 MZ twin     1               &lt;NA&gt;</span></span>
<span><span class="co">## 2 2_204 2_205    &lt;NA&gt;     2 code_not_recognise</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h3>
<p>Now that the data for the Pedigree object creation are ready, they
are given to a new <code>Pedigree</code> object, trigerring the
<em>validation</em> process.</p>
<p>This validation step will check up for many errors such as:</p>
<ul>
<li>All necessary columns are present</li>
<li>No duplicated <code>id</code>
</li>
<li>All <code>momid</code> and <code>dadid</code> are present in
<code>id</code>
</li>
<li>
<code>sex</code> column only contain “male”, “female”, “unknown” or
“terminated” values</li>
<li>
<code>steril</code>, <code>deceased</code>, <code>avail</code>,
<code>affected</code> only contains 0, 1 or NA values</li>
<li>Father are males and Mother are females</li>
<li>Twins have same parents and MZ twins have same sex</li>
<li>Hints object is valid and ids contained is in the Ped object</li>
<li>…</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="pedigree-class">Pedigree Class<a class="anchor" aria-label="anchor" href="#pedigree-class"></a>
</h2>
<p>After validation an <span class="math inline">S4</span> object is
generated. This new concept make it possible to easily setup methods for
this new type of object. The controls of the parameters is also more
precise.</p>
<p>The <code>Pedigree</code> object contains 4 slots, each of them
contains a different <span class="math inline">S4</span> object
containing a specific type of information used for the Pedigree
construction.</p>
<ul>
<li>
<code>ped</code> a Ped object for the Pedigree information with at
least the following slots:
<ul>
<li>
<code>id</code> the identifiers of the individuals</li>
<li>
<code>dadid</code> the identifiers of the fathers</li>
<li>
<code>momid</code> the identifiers of the mothers</li>
<li>
<code>sex</code> the gender of each individuals</li>
</ul>
</li>
<li>
<code>rel</code> a Rel object describing all special relationship
beetween individuals that can’t be descibed in the <code>ped</code>
slot. The minimal slots needed are :
<ul>
<li>
<code>id1</code> the identifiers of the 1st individuals</li>
<li>
<code>id2</code> the identifiers of the 2nd individuals</li>
<li>
<code>code</code> factor describing the type of relationship (“MZ
twin”, “DZ twin”, “UZ twin”, “Spouse”)</li>
</ul>
</li>
<li>
<code>scales</code> a Scales object with two slots :
<ul>
<li>
<code>fill</code> a dataframe describing which modalities in which
columns correspond to an affected individuals. Plotting information such
as colour, angle and density are also provided</li>
<li>
<code>border</code> a dataframe describing which modalities in which
columns to use to plot the border of the plot elements.</li>
</ul>
</li>
<li>
<code>hints</code> a Hints object with two slots :
<ul>
<li>
<code>horder</code> numeric vector for the ordering of the
individuals plotting</li>
<li>
<code>spouse</code> a matrix of the spouses</li>
</ul>
</li>
</ul>
<p>For more information on each object:</p>
<ul>
<li><code><a href="../reference/Ped-class.html">help(Ped)</a></code></li>
<li><code><a href="../reference/Rel-class.html">help(Rel)</a></code></li>
<li><code><a href="../reference/Scales-class.html">help(Scales)</a></code></li>
<li><code><a href="../reference/Hints-class.html">help(Hints)</a></code></li>
</ul>
</div>
<div class="section level2">
<h2 id="pedigree-accessors">Pedigree accessors<a class="anchor" aria-label="anchor" href="#pedigree-accessors"></a>
</h2>
<p>As the Pedigree object is now an <span class="math inline">S4</span>
class, we have made available a number of accessors. Most of them can be
used as a getter or as a setter to modify a value in the correponding
slot of the object</p>
<div class="section level3">
<h3 id="for-the-pedigree-object">For the Pedigree object<a class="anchor" aria-label="anchor" href="#for-the-pedigree-object"></a>
</h3>
<ul>
<li>Get/Set slots : <code><a href="../reference/Pedigree-class.html">ped()</a></code>, <code><a href="../reference/Pedigree-class.html">rel()</a></code>,
<code><a href="../reference/Pedigree-class.html">scales()</a></code>, <code><a href="../reference/Pedigree-class.html">hints()</a></code>
</li>
<li>Wrapper to the Ped object: <code>mcols()</code>
</li>
<li>Wrapper of the Scales object: <code><a href="../reference/Scales-class.html">fill()</a></code>,
<code><a href="../reference/Scales-class.html">border()</a></code>
</li>
<li>Wrapper of the Hints object: <code><a href="../reference/Hints-class.html">horder()</a></code>,
<code><a href="../reference/Hints-class.html">spouse()</a></code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="for-the-ped-object">For the Ped object<a class="anchor" aria-label="anchor" href="#for-the-ped-object"></a>
</h3>
<ul>
<li>Given in input: <code><a href="../reference/Ped-class.html">id()</a></code>, <code><a href="../reference/Ped-class.html">dadid()</a></code>,
<code><a href="../reference/Ped-class.html">momid()</a></code>, <code><a href="../reference/Ped-class.html">famid()</a></code>, <code><a href="../reference/Ped-class.html">sex()</a></code>
</li>
<li>Other infos used : <code><a href="../reference/Ped-class.html">affected()</a></code>, <code><a href="../reference/Ped-class.html">avail()</a></code>,
<code><a href="../reference/Ped-class.html">deceased()</a></code>
</li>
<li>Computed : <code><a href="../reference/Ped-class.html">isinf()</a></code>, <code><a href="../reference/Ped-class.html">kin()</a></code>,
<code><a href="../reference/Ped-class.html">useful()</a></code>
</li>
<li>Metadata : <code>mcols()</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="for-the-rel-object">For the Rel object<a class="anchor" aria-label="anchor" href="#for-the-rel-object"></a>
</h3>
<ul>
<li>
<code><a href="../reference/Rel-class.html">id1()</a></code>, <code><a href="../reference/Rel-class.html">id2()</a></code>, <code><a href="../reference/Rel-class.html">code()</a></code>,
<code><a href="../reference/Ped-class.html">famid()</a></code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="for-the-scales-object">For the Scales object<a class="anchor" aria-label="anchor" href="#for-the-scales-object"></a>
</h3>
<ul>
<li>
<code><a href="../reference/Scales-class.html">fill()</a></code>, <code><a href="../reference/Scales-class.html">border()</a></code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="for-the-hints-object">For the Hints object<a class="anchor" aria-label="anchor" href="#for-the-hints-object"></a>
</h3>
<ul>
<li>
<code><a href="../reference/Hints-class.html">horder()</a></code>, <code><a href="../reference/Hints-class.html">spouse()</a></code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="focus-on-mcols">Focus on <code>mcols()</code><a class="anchor" aria-label="anchor" href="#focus-on-mcols"></a>
</h3>
<p>The <code>mcols()</code> accessors is the one you should use to add
more informations to your individuals.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pedigree-class.html">Pedigree</a></span><span class="op">(</span><span class="va">sampleped</span><span class="op">)</span></span>
<span><span class="fu">mcols</span><span class="op">(</span><span class="va">ped</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 55 rows and 5 columns</span></span>
<span><span class="co">##     affection       num       error affection_mods avail_mods</span></span>
<span><span class="co">##     &lt;integer&gt; &lt;integer&gt; &lt;character&gt;      &lt;numeric&gt;  &lt;numeric&gt;</span></span>
<span><span class="co">## 1           0         2          NA              0          0</span></span>
<span><span class="co">## 2           1         3          NA              1          0</span></span>
<span><span class="co">## 3           1         2          NA              1          0</span></span>
<span><span class="co">## 4           0         4          NA              0          0</span></span>
<span><span class="co">## 5          NA         6          NA             NA          0</span></span>
<span><span class="co">## ...       ...       ...         ...            ...        ...</span></span>
<span><span class="co">## 51          0         2          NA              0          0</span></span>
<span><span class="co">## 52          0         1          NA              0          1</span></span>
<span><span class="co">## 53          0         3          NA              0          1</span></span>
<span><span class="co">## 54          0         2          NA              0          0</span></span>
<span><span class="co">## 55          1         0          NA              1          1</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Add new columns as a threshold if identifiers of individuals superior</span></span>
<span><span class="co">## to a given threshold for example</span></span>
<span><span class="fu">mcols</span><span class="op">(</span><span class="va">ped</span><span class="op">)</span><span class="op">$</span><span class="va">idth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split_i</a></span><span class="op">(</span><span class="fu"><a href="../reference/Ped-class.html">id</a></span><span class="op">(</span><span class="fu"><a href="../reference/Pedigree-class.html">ped</a></span><span class="op">(</span><span class="va">ped</span><span class="op">)</span><span class="op">)</span>, <span class="st">"_"</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">200</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="fu">mcols</span><span class="op">(</span><span class="va">ped</span><span class="op">)</span><span class="op">$</span><span class="va">idth</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A"</span></span>
<span><span class="co">## [20] "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A"</span></span>
<span><span class="co">## [39] "A" "A" "A" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B" "B"</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="pedigree-methods">Pedigree methods<a class="anchor" aria-label="anchor" href="#pedigree-methods"></a>
</h2>
<p>With this new S4 object comes multiple methods to ease the use of
it:</p>
<ul>
<li><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code></li>
<li><code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code></li>
<li><code>show()</code></li>
<li><code><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list()</a></code></li>
<li><code>[</code></li>
<li><code><a href="../reference/shrink.html">shrink()</a></code></li>
<li><code><a href="../reference/generate_colors.html">generate_colors()</a></code></li>
<li><code><a href="../reference/is_informative.html">is_informative()</a></code></li>
<li><code><a href="../reference/kindepth.html">kindepth()</a></code></li>
<li><code><a href="../reference/kinship.html">kinship()</a></code></li>
<li><code><a href="../reference/make_famid.html">make_famid()</a></code></li>
<li><code><a href="../reference/upd_famid.html">upd_famid()</a></code></li>
<li><code><a href="../reference/num_child.html">num_child()</a></code></li>
<li><code><a href="../reference/unrelated.html">unrelated()</a></code></li>
<li><code><a href="../reference/useful_inds.html">useful_inds()</a></code></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## We can change the family name based on an other column</span></span>
<span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/upd_famid.html">upd_famid</a></span><span class="op">(</span><span class="va">ped</span>, <span class="fu">mcols</span><span class="op">(</span><span class="va">ped</span><span class="op">)</span><span class="op">$</span><span class="va">idth</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## We can substract a given family</span></span>
<span><span class="va">ped_a</span> <span class="op">&lt;-</span> <span class="va">ped</span><span class="op">[</span><span class="fu"><a href="../reference/Ped-class.html">famid</a></span><span class="op">(</span><span class="fu"><a href="../reference/Pedigree-class.html">ped</a></span><span class="op">(</span><span class="va">ped</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Plot it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ped_a</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="pedigree_object_files/figure-html/pedigree_methods-1.png" alt="Pedigree plot" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Do a summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ped_a</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Pedigree object with </span></span>
<span><span class="co">## [1] "Ped object with 41 individuals and 6 metadata columns"</span></span>
<span><span class="co">## [1] "Rel object with 0 relationshipswith 0 MZ twin, 0 DZ twin, 0 UZ twin, 0 Spouse"</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Coerce it to a list</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">ped_a</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## $id</span></span>
<span><span class="co">##  [1] "A_101" "A_102" "A_103" "A_104" "A_105" "A_106" "A_107" "A_108" "A_109"</span></span>
<span><span class="co">## [10] "A_110" "A_111" "A_112" "A_113" "A_114" "A_115" "A_116" "A_117" "A_118"</span></span>
<span><span class="co">## [19] "A_119" "A_120" "A_121" "A_122" "A_123" "A_124" "A_125" "A_126" "A_127"</span></span>
<span><span class="co">## [28] "A_128" "A_129" "A_130" "A_131" "A_132" "A_133" "A_134" "A_135" "A_136"</span></span>
<span><span class="co">## [37] "A_137" "A_138" "A_139" "A_140" "A_141"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dadid</span></span>
<span><span class="co">##  [1] NA      NA      "A_135" NA      NA      NA      NA      NA      "A_101"</span></span>
<span><span class="co">## [10] "A_103" "A_103" "A_103" NA      "A_103" "A_105" "A_105" NA      "A_105"</span></span>
<span><span class="co">## [19] "A_105" "A_107" "A_110" "A_110" "A_110" "A_110" "A_112" "A_112" "A_114"</span></span>
<span><span class="co">## [28] "A_114" "A_117" "A_119" "A_119" "A_119" "A_119" "A_119" NA      NA     </span></span>
<span><span class="co">## [37] NA      "A_135" "A_137" "A_137" "A_137"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $momid</span></span>
<span><span class="co">##  [1] NA      NA      "A_136" NA      NA      NA      NA      NA      "A_102"</span></span>
<span><span class="co">## [10] "A_104" "A_104" "A_104" NA      "A_104" "A_106" "A_106" NA      "A_106"</span></span>
<span><span class="co">## [19] "A_106" "A_108" "A_109" "A_109" "A_109" "A_109" "A_118" "A_118" "A_115"</span></span>
<span><span class="co">## [28] "A_115" "A_116" "A_120" "A_120" "A_120" "A_120" "A_120" NA      NA     </span></span>
<span><span class="co">## [37] NA      "A_136" "A_138" "A_138" "A_138"</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Shrink it to keep only the necessary information</span></span>
<span><span class="va">lst1_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shrink.html">shrink</a></span><span class="op">(</span><span class="va">ped_a</span>, max_bits <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lst1_s</span><span class="op">$</span><span class="va">pedObj</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="pedigree_object_files/figure-html/pedigree_methods-2.png" alt="Pedigree plot" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Compute the kinship individuals matrix</span></span>
<span><span class="fu"><a href="../reference/kinship.html">kinship</a></span><span class="op">(</span><span class="va">ped_a</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 x 10 sparse Matrix of class "dsCMatrix"</span></span></code></pre>
<pre><code><span><span class="co">##   [[ suppressing 10 column names 'A_101', 'A_102', 'A_103' ... ]]</span></span></code></pre>
<pre><code><span><span class="co">##                                                    </span></span>
<span><span class="co">## A_101 0.50 .    .    .    .   .   .   .   0.25 .   </span></span>
<span><span class="co">## A_102 .    0.50 .    .    .   .   .   .   0.25 .   </span></span>
<span><span class="co">## A_103 .    .    0.50 .    .   .   .   .   .    0.25</span></span>
<span><span class="co">## A_104 .    .    .    0.50 .   .   .   .   .    0.25</span></span>
<span><span class="co">## A_105 .    .    .    .    0.5 .   .   .   .    .   </span></span>
<span><span class="co">## A_106 .    .    .    .    .   0.5 .   .   .    .   </span></span>
<span><span class="co">## A_107 .    .    .    .    .   .   0.5 .   .    .   </span></span>
<span><span class="co">## A_108 .    .    .    .    .   .   .   0.5 .    .   </span></span>
<span><span class="co">## A_109 0.25 0.25 .    .    .   .   .   .   0.50 .   </span></span>
<span><span class="co">## A_110 .    .    0.25 0.25 .   .   .   .   .    0.50</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Get the useful individuals</span></span>
<span><span class="va">ped_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/is_informative.html">is_informative</a></span><span class="op">(</span><span class="va">ped_a</span>, informative <span class="op">=</span> <span class="st">"AvAf"</span>, col_aff <span class="op">=</span> <span class="st">"affection"</span><span class="op">)</span></span>
<span><span class="va">ped_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/useful_inds.html">useful_inds</a></span><span class="op">(</span><span class="va">ped_a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/Pedigree-class.html">ped</a></span><span class="op">(</span><span class="va">ped_a</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="st">"useful"</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] Pedixplorer_1.3.1 BiocStyle_2.32.1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] gtable_0.3.6          xfun_0.50             bslib_0.9.0          </span></span>
<span><span class="co">##  [4] ggplot2_3.5.1         htmlwidgets_1.6.4     lattice_0.22-6       </span></span>
<span><span class="co">##  [7] quadprog_1.5-8        vctrs_0.6.5           tools_4.4.2          </span></span>
<span><span class="co">## [10] generics_0.1.3        stats4_4.4.2          tibble_3.2.1         </span></span>
<span><span class="co">## [13] pkgconfig_2.0.3       Matrix_1.7-2          data.table_1.16.4    </span></span>
<span><span class="co">## [16] desc_1.4.3            S4Vectors_0.42.1      readxl_1.4.3         </span></span>
<span><span class="co">## [19] lifecycle_1.0.4       compiler_4.4.2        stringr_1.5.1        </span></span>
<span><span class="co">## [22] shinytoastr_2.2.0     textshaping_1.0.0     munsell_0.5.1        </span></span>
<span><span class="co">## [25] httpuv_1.6.15         shinyWidgets_0.8.7    htmltools_0.5.8.1    </span></span>
<span><span class="co">## [28] sass_0.4.9            yaml_2.3.10           lazyeval_0.2.2       </span></span>
<span><span class="co">## [31] plotly_4.10.4         later_1.4.1           pillar_1.10.1        </span></span>
<span><span class="co">## [34] pkgdown_2.1.1         jquerylib_0.1.4       tidyr_1.3.1          </span></span>
<span><span class="co">## [37] DT_0.33               cachem_1.1.0          mime_0.12            </span></span>
<span><span class="co">## [40] tidyselect_1.2.1      digest_0.6.37         stringi_1.8.4        </span></span>
<span><span class="co">## [43] colourpicker_1.3.0    dplyr_1.1.4           purrr_1.0.4          </span></span>
<span><span class="co">## [46] bookdown_0.42         fastmap_1.2.0         grid_4.4.2           </span></span>
<span><span class="co">## [49] colorspace_2.1-1      cli_3.6.3             magrittr_2.0.3       </span></span>
<span><span class="co">## [52] withr_3.0.2           scales_1.3.0          promises_1.3.2       </span></span>
<span><span class="co">## [55] rmarkdown_2.29        httr_1.4.7            gridExtra_2.3        </span></span>
<span><span class="co">## [58] cellranger_1.1.0      ragg_1.3.3            shiny_1.10.0         </span></span>
<span><span class="co">## [61] evaluate_1.0.3        knitr_1.49            shinycssloaders_1.1.0</span></span>
<span><span class="co">## [64] miniUI_0.1.1.1        viridisLite_0.4.2     rlang_1.1.5          </span></span>
<span><span class="co">## [67] Rcpp_1.0.14           xtable_1.8-4          glue_1.8.0           </span></span>
<span><span class="co">## [70] BiocManager_1.30.25   BiocGenerics_0.50.0   jsonlite_1.8.9       </span></span>
<span><span class="co">## [73] R6_2.5.1              plyr_1.8.9            systemfonts_1.2.1    </span></span>
<span><span class="co">## [76] fs_1.6.5</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Le Nézet, Jason Sinnwell, Terry Therneau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
